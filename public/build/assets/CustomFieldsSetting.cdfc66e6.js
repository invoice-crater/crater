import{aa as ae,u as ne,l as z,ai as H,M as re,N as W,I as G,a5 as Z,r as i,o as y,j as g,h as n,a as s,x as e,R as x,z as D,t as T,g as A,d as L,c as R,aB as ue,w as ee,K as Q,e as B,an as ie,p as k,q as M,at as de,v as me,b as O,y as ce,F as pe,i as _e,n as j,a4 as fe,ao as b,a6 as ve}from"./main.f7d24694.js";const ye={__name:"CustomFieldIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(w){const c=w,t=ae();ne();const{t:u}=z(),p=H();re();const f=W(),d=G();Z("utils");async function m(v){await p.fetchCustomField(v),d.openModal({title:u("settings.custom_fields.edit_custom_field"),componentName:"CustomFieldModal",size:"sm",data:v,refreshData:c.loadData})}async function V(v){t.openDialog({title:u("general.are_you_sure"),message:u("settings.custom_fields.custom_field_confirm_delete"),yesLabel:u("general.ok"),noLabel:u("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async F=>{F&&(await p.deleteCustomFields(v),c.loadData&&c.loadData())})}return(v,F)=>{const _=i("BaseIcon"),h=i("BaseDropdownItem"),I=i("BaseDropdown");return y(),g(I,null,{activator:n(()=>[s(_,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"})]),default:n(()=>[e(f).hasAbilities(e(x).EDIT_CUSTOM_FIELDS)?(y(),g(h,{key:0,onClick:F[0]||(F[0]=o=>m(w.row.id))},{default:n(()=>[s(_,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),D(" "+T(v.$t("general.edit")),1)]),_:1})):A("",!0),e(f).hasAbilities(e(x).DELETE_CUSTOM_FIELDS)?(y(),g(h,{key:1,onClick:F[1]||(F[1]=o=>V(w.row.id))},{default:n(()=>[s(_,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),D(" "+T(v.$t("general.delete")),1)]),_:1})):A("",!0)]),_:1})}}},Ce={class:"flex items-center mt-1"},Fe={__name:"OptionsCreate",emits:["onAdd"],setup(w,{emit:c}){const t=c,u=L(null);function p(){if(u.value==null||u.value==""||u.value==null)return!0;t("onAdd",u.value),u.value=null}return(f,d)=>{const m=i("BaseInput"),V=i("BaseIcon");return y(),R("div",Ce,[s(m,{modelValue:u.value,"onUpdate:modelValue":d[0]||(d[0]=v=>u.value=v),type:"text",class:"w-full md:w-96",placeholder:f.$t("settings.custom_fields.press_enter_to_add"),onClick:p,onKeydown:ue(ee(p,["prevent","stop"]),["enter"])},null,8,["modelValue","placeholder","onKeydown"]),s(V,{name:"PlusCircleIcon",class:"ml-1 text-primary-500 cursor-pointer",onClick:p})])}}};function be(w){switch(w){case"../../custom-fields/types/DateTimeType.vue":return b(()=>import("./DateTimeType.2024721b.js"),["assets/DateTimeType.2024721b.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/DateType.vue":return b(()=>import("./DateType.83bdb432.js"),["assets/DateType.83bdb432.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/DropdownType.vue":return b(()=>import("./DropdownType.75653313.js"),["assets/DropdownType.75653313.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/InputType.vue":return b(()=>import("./InputType.b2082bd9.js"),["assets/InputType.b2082bd9.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/NumberType.vue":return b(()=>import("./NumberType.d5a66439.js"),["assets/NumberType.d5a66439.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/PhoneType.vue":return b(()=>import("./PhoneType.563aaa0d.js"),["assets/PhoneType.563aaa0d.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/SwitchType.vue":return b(()=>import("./SwitchType.e354edfe.js"),["assets/SwitchType.e354edfe.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/TextAreaType.vue":return b(()=>import("./TextAreaType.1a4160d3.js"),["assets/TextAreaType.1a4160d3.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/TimeType.vue":return b(()=>import("./TimeType.5bd19f24.js"),["assets/TimeType.5bd19f24.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);case"../../custom-fields/types/UrlType.vue":return b(()=>import("./UrlType.d2c7933b.js"),["assets/UrlType.d2c7933b.js","assets/main.f7d24694.js","assets/main.d9b970db.css"]);default:return new Promise(function(c,t){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(t.bind(null,new Error("Unknown variable dynamic import: "+w)))})}}const ge={class:"flex justify-between w-full"},we={class:"overflow-y-auto max-h-[550px]"},$e={class:"px-4 md:px-8 py-8 overflow-y-auto sm:p-6"},Te={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light border-modal-bg"},Ie={__name:"CustomFieldModal",setup(w){const c=G(),t=H(),{t:u}=z();let p=L(!1);const f=Q(["Customer","Invoice","Estimate","Expense","Payment"]),d=Q([{label:"Text",value:"Input"},{label:"Textarea",value:"TextArea"},{label:"Phone",value:"Phone"},{label:"URL",value:"Url"},{label:"Number",value:"Number"},{label:"Select Field",value:"Dropdown"},{label:"Switch Toggle",value:"Switch"},{label:"Date",value:"Date"},{label:"Time",value:"Time"},{label:"Date & Time",value:"DateTime"}]);let m=L(d[0]);const V=B(()=>c.active&&c.componentName==="CustomFieldModal"),v=B(()=>m.value&&m.value.label==="Switch Toggle"),F=B(()=>m.value&&m.value.label==="Select Field"),_=B(()=>t.currentCustomField.type?ie(()=>be(`../../custom-fields/types/${t.currentCustomField.type}Type.vue`)):!1),h=B({get:()=>t.currentCustomField.is_required===1,set:l=>{const a=l?1:0;t.currentCustomField.is_required=a}}),I=B(()=>({currentCustomField:{type:{required:k.withMessage(u("validation.required"),M)},name:{required:k.withMessage(u("validation.required"),M)},label:{required:k.withMessage(u("validation.required"),M)},model_type:{required:k.withMessage(u("validation.required"),M)},order:{required:k.withMessage(u("validation.required"),M),numeric:k.withMessage(u("validation.numbers_only"),de)},type:{required:k.withMessage(u("validation.required"),M)}}})),o=me(I,B(()=>t));function S(){t.isEdit?m.value=d.find(l=>l.value==t.currentCustomField.type):(t.currentCustomField.model_type=f[0],t.currentCustomField.type=d[0].value,m.value=d[0])}async function P(){if(o.value.currentCustomField.$touch(),o.value.currentCustomField.$invalid)return!0;p.value=!0;let l={...t.currentCustomField};if(t.currentCustomField.options&&(l.options=t.currentCustomField.options.map(E=>E.name)),l.type=="Time"&&typeof l.default_answer=="object"){let E=l&&l.default_answer&&l.default_answer.HH?l.default_answer.HH:null,q=l&&l.default_answer&&l.default_answer.mm?l.default_answer.mm:null;l&&l.default_answer&&l.default_answer.ss&&l.default_answer.ss,l.default_answer=`${E}:${q}`}await(t.isEdit?t.updateCustomField:t.addCustomField)(l),p.value=!1,c.refreshData&&c.refreshData(),N()}function U(l){t.currentCustomField.options=[{name:l},...t.currentCustomField.options]}function C(l){if(t.isEdit&&t.currentCustomField.in_use)return;t.currentCustomField.options[l].name===t.currentCustomField.default_answer&&(t.currentCustomField.default_answer=null),t.currentCustomField.options.splice(l,1)}function te(l){t.currentCustomField.type=l.value}function N(){c.closeModal(),setTimeout(()=>{t.resetCurrentCustomField(),o.value.$reset()},300)}return(l,a)=>{const E=i("BaseIcon"),q=i("BaseInput"),$=i("BaseInputGroup"),K=i("BaseMultiselect"),le=i("BaseSwitch"),se=i("BaseInputGrid"),Y=i("BaseButton"),oe=i("BaseModal");return y(),g(oe,{show:V.value,onOpen:S},{header:n(()=>[O("div",ge,[D(T(e(c).title)+" ",1),s(E,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:N})])]),default:n(()=>[O("form",{action:"",onSubmit:ee(P,["prevent"])},[O("div",we,[O("div",$e,[s(se,{layout:"one-column"},{default:n(()=>[s($,{label:l.$t("settings.custom_fields.name"),required:"",error:e(o).currentCustomField.name.$error&&e(o).currentCustomField.name.$errors[0].$message},{default:n(()=>[s(q,{ref:"name",modelValue:e(t).currentCustomField.name,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).currentCustomField.name=r),invalid:e(o).currentCustomField.name.$error,onInput:a[1]||(a[1]=r=>e(o).currentCustomField.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),s($,{label:l.$t("settings.custom_fields.model"),error:e(o).currentCustomField.model_type.$error&&e(o).currentCustomField.model_type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.model_in_use"):"",required:""},{default:n(()=>[s(K,{modelValue:e(t).currentCustomField.model_type,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).currentCustomField.model_type=r),options:f,"can-deselect":!1,invalid:e(o).currentCustomField.model_type.$error,searchable:!0,disabled:e(t).currentCustomField.in_use,onInput:a[3]||(a[3]=r=>e(o).currentCustomField.model_type.$touch())},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s($,{class:"flex items-center space-x-4",label:l.$t("settings.custom_fields.required")},{default:n(()=>[s(le,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=r=>h.value=r)},null,8,["modelValue"])]),_:1},8,["label"]),s($,{label:l.$t("settings.custom_fields.type"),error:e(o).currentCustomField.type.$error&&e(o).currentCustomField.type.$errors[0].$message,"help-text":e(t).currentCustomField.in_use?l.$t("settings.custom_fields.type_in_use"):"",required:""},{default:n(()=>[s(K,{modelValue:e(m),"onUpdate:modelValue":[a[5]||(a[5]=r=>ce(m)?m.value=r:m=r),te],options:d,invalid:e(o).currentCustomField.type.$error,disabled:e(t).currentCustomField.in_use,searchable:!0,"can-deselect":!1,object:""},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),s($,{label:l.$t("settings.custom_fields.label"),required:"",error:e(o).currentCustomField.label.$error&&e(o).currentCustomField.label.$errors[0].$message},{default:n(()=>[s(q,{modelValue:e(t).currentCustomField.label,"onUpdate:modelValue":a[6]||(a[6]=r=>e(t).currentCustomField.label=r),invalid:e(o).currentCustomField.label.$error,onInput:a[7]||(a[7]=r=>e(o).currentCustomField.label.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),F.value?(y(),g($,{key:0,label:l.$t("settings.custom_fields.options")},{default:n(()=>[s(Fe,{onOnAdd:U}),(y(!0),R(pe,null,_e(e(t).currentCustomField.options,(r,X)=>(y(),R("div",{key:X,class:"flex items-center mt-5"},[s(q,{modelValue:r.name,"onUpdate:modelValue":J=>r.name=J,class:"w-64"},null,8,["modelValue","onUpdate:modelValue"]),s(E,{name:"MinusCircleIcon",class:j(["ml-1 cursor-pointer",e(t).currentCustomField.in_use?"text-gray-300":"text-red-300"]),onClick:J=>C(X)},null,8,["class","onClick"])]))),128))]),_:1},8,["label"])):A("",!0),s($,{label:l.$t("settings.custom_fields.default_value"),class:"relative"},{default:n(()=>[(y(),g(fe(_.value),{modelValue:e(t).currentCustomField.default_answer,"onUpdate:modelValue":a[8]||(a[8]=r=>e(t).currentCustomField.default_answer=r),options:e(t).currentCustomField.options,"default-date-time":e(t).currentCustomField.dateTimeValue},null,8,["modelValue","options","default-date-time"]))]),_:1},8,["label"]),v.value?A("",!0):(y(),g($,{key:1,label:l.$t("settings.custom_fields.placeholder")},{default:n(()=>[s(q,{modelValue:e(t).currentCustomField.placeholder,"onUpdate:modelValue":a[9]||(a[9]=r=>e(t).currentCustomField.placeholder=r)},null,8,["modelValue"])]),_:1},8,["label"])),s($,{label:l.$t("settings.custom_fields.order"),error:e(o).currentCustomField.order.$error&&e(o).currentCustomField.order.$errors[0].$message,required:""},{default:n(()=>[s(q,{modelValue:e(t).currentCustomField.order,"onUpdate:modelValue":a[10]||(a[10]=r=>e(t).currentCustomField.order=r),type:"number",invalid:e(o).currentCustomField.order.$error,onInput:a[11]||(a[11]=r=>e(o).currentCustomField.order.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})])]),O("div",Te,[s(Y,{class:"mr-3",type:"button",variant:"primary-outline",onClick:N},{default:n(()=>[D(T(l.$t("general.cancel")),1)]),_:1}),s(Y,{variant:"primary",loading:e(p),disabled:e(p),type:"submit"},{left:n(r=>[e(p)?A("",!0):(y(),g(E,{key:0,class:j(r.class),name:"SaveIcon"},null,8,["class"]))]),default:n(()=>[D(" "+T(e(t).isEdit?l.$t("general.update"):l.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],32)]),_:1},8,["show"])}}},Be={class:"text-xs text-gray-500"},Ve={__name:"CustomFieldsSetting",setup(w){const c=G(),t=H(),u=W(),p=Z("utils"),{t:f}=z(),d=L(null),m=B(()=>[{key:"name",label:f("settings.custom_fields.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"model_type",label:f("settings.custom_fields.model")},{key:"type",label:f("settings.custom_fields.type")},{key:"is_required",label:f("settings.custom_fields.required")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function V({page:_,filter:h,sort:I}){let o={orderByField:I.fieldName||"created_at",orderBy:I.order||"desc",page:_},S=await t.fetchCustomFields(o);return{data:S.data.data,pagination:{totalPages:S.data.meta.last_page,currentPage:_,limit:5,totalCount:S.data.meta.total}}}function v(){c.openModal({title:f("settings.custom_fields.add_custom_field"),componentName:"CustomFieldModal",size:"sm",refreshData:d.value&&d.value.refresh})}async function F(){d.value&&d.value.refresh()}return(_,h)=>{const I=i("BaseIcon"),o=i("BaseButton"),S=i("BaseBadge"),P=i("BaseTable"),U=i("BaseSettingCard");return y(),g(U,{title:_.$t("settings.menu_title.custom_fields"),description:_.$t("settings.custom_fields.section_description")},{action:n(()=>[e(u).hasAbilities(e(x).CREATE_CUSTOM_FIELDS)?(y(),g(o,{key:0,variant:"primary-outline",onClick:v},{left:n(C=>[s(I,{class:j(C.class),name:"PlusIcon"},null,8,["class"]),D(" "+T(_.$t("settings.custom_fields.add_custom_field")),1)]),_:1})):A("",!0)]),default:n(()=>[s(Ie),s(P,{ref_key:"table",ref:d,data:V,columns:m.value,class:"mt-16"},ve({"cell-name":n(({row:C})=>[D(T(C.data.name)+" ",1),O("span",Be," ("+T(C.data.slug)+")",1)]),"cell-is_required":n(({row:C})=>[s(S,{"bg-color":e(p).getBadgeStatusColor(C.data.is_required?"YES":"NO").bgColor,color:e(p).getBadgeStatusColor(C.data.is_required?"YES":"NO").color},{default:n(()=>[D(T(C.data.is_required?_.$t("settings.custom_fields.yes"):_.$t("settings.custom_fields.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),_:2},[e(u).hasAbilities([e(x).DELETE_CUSTOM_FIELDS,e(x).EDIT_CUSTOM_FIELDS])?{name:"cell-actions",fn:n(({row:C})=>[s(ye,{row:C.data,table:d.value,"load-data":F},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"])]),_:1},8,["title","description"])}}};export{Ve as default};
