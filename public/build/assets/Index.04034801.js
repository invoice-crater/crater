import{B as v,J as le,a0 as oe,k as x,aR as ne,aS as re,I as ue,r as n,o as p,l as f,w as a,f as t,h as d,q as F,ag as A,u as l,m as k,i as b,t as i,j as U,V as me,x as M}from"./vendor.6e01bba6.js";import{b as ce,j as de,l as ie,e as pe,g as C}from"./main.9dc490c3.js";import{_ as fe}from"./CustomerIndexDropdown.28bcab4d.js";import{_ as _e}from"./AstronautIcon.d83b9664.js";const ye={class:"flex items-center justify-end space-x-5"},he={class:"relative table-container"},be={class:"relative flex items-center justify-end h-5"},Ce={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Be={class:"absolute z-10 items-center left-6 top-2.5 select-none"},ge={class:"relative block"},$e={setup(ve){ce();const W=de(),u=ie(),V=pe();let _=v(null),y=v(!1),I=v(!0);const{t:c}=le();let r=oe({display_name:"",ftid:"",contact_name:"",phone:""});const P=x(()=>!u.totalCustomers&&!I.value),$=x({get:()=>u.selectedCustomers,set:s=>u.selectCustomer(s)}),S=x({get:()=>u.selectAllField,set:s=>u.setSelectAllState(s)}),Y=x(()=>[{key:"status",thClass:"extra w-10 pr-0",sortable:!1,tdClass:"font-medium text-gray-900 pr-0"},{key:"name",label:c("customers.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"ftid",label:c("customers.ftid"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"phone",label:c("customers.phone")},{key:"due_amount",label:c("customers.amount_due")},{key:"created_at",label:c("items.added_on")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"pl-0",sortable:!1}]);ne(r,()=>{z()},{debounce:500}),re(()=>{u.selectAllField&&u.selectAllCustomers()});function D(){_.value.refresh()}function z(){D()}function L(){return V.hasAbilities([C.DELETE_CUSTOMER,C.EDIT_CUSTOMER,C.VIEW_CUSTOMER])}async function G({page:s,filter:o,sort:h}){let E={display_name:r.display_name,ftid:r.ftid,contact_name:r.contact_name,phone:r.phone,orderByField:h.fieldName||"created_at",orderBy:h.order||"desc",page:s};I.value=!0;let m=await u.fetchCustomers(E);return I.value=!1,{data:m.data.data,pagination:{totalPages:m.data.meta.last_page,currentPage:s,totalCount:m.data.meta.total,limit:10}}}function R(){r.display_name="",r.contact_name="",r.phone=""}function H(){y.value&&R(),y.value=!y.value}let j=v(new Date);j.value=ue(j).format("YYYY-MM-DD");function q(){W.openDialog({title:c("general.are_you_sure"),message:c("customers.confirm_delete",2),yesLabel:c("general.ok"),noLabel:c("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(s=>{s&&u.deleteMultipleCustomers().then(o=>{o.data&&D()})})}return(s,o)=>{const h=n("BaseBreadcrumbItem"),E=n("BaseBreadcrumb"),m=n("BaseIcon"),w=n("BaseButton"),J=n("BasePageHeader"),B=n("BaseInput"),g=n("BaseInputGroup"),X=n("BaseFilterWrapper"),K=n("BaseEmptyPlaceholder"),Q=n("BaseDropdownItem"),Z=n("BaseDropdown"),N=n("BaseCheckbox"),O=n("BaseText"),ee=n("router-link"),te=n("BaseFormatMoney"),ae=n("BaseTable"),se=n("BasePage");return p(),f(se,null,{default:a(()=>[t(J,{title:s.$t("customers.title")},{actions:a(()=>[d("div",ye,[F(t(w,{variant:"primary-outline",onClick:H},{right:a(e=>[l(y)?(p(),f(m,{key:1,name:"XIcon",class:k(e.class)},null,8,["class"])):(p(),f(m,{key:0,name:"FilterIcon",class:k(e.class)},null,8,["class"]))]),default:a(()=>[b(i(s.$t("general.filter"))+" ",1)]),_:1},512),[[A,l(u).totalCustomers]]),l(V).hasAbilities(l(C).CREATE_CUSTOMER)?(p(),f(w,{key:0,onClick:o[0]||(o[0]=e=>s.$router.push("customers/create"))},{left:a(e=>[t(m,{name:"PlusIcon",class:k(e.class)},null,8,["class"])]),default:a(()=>[b(" "+i(s.$t("customers.new_customer")),1)]),_:1})):U("",!0)])]),default:a(()=>[t(E,null,{default:a(()=>[t(h,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),t(h,{title:s.$tc("customers.customer",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),t(X,{show:l(y),class:"mt-5",onClear:R},{default:a(()=>[t(g,{label:s.$t("customers.display_name"),class:"text-left"},{default:a(()=>[t(B,{modelValue:l(r).display_name,"onUpdate:modelValue":o[1]||(o[1]=e=>l(r).display_name=e),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(g,{label:s.$t("customers.ftid"),class:"text-left"},{default:a(()=>[t(B,{modelValue:l(r).ftid,"onUpdate:modelValue":o[2]||(o[2]=e=>l(r).ftid=e),type:"text",name:"address_name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(g,{label:s.$t("customers.contact_name"),class:"text-left"},{default:a(()=>[t(B,{modelValue:l(r).contact_name,"onUpdate:modelValue":o[3]||(o[3]=e=>l(r).contact_name=e),type:"text",name:"address_name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(g,{label:s.$t("customers.phone"),class:"text-left"},{default:a(()=>[t(B,{modelValue:l(r).phone,"onUpdate:modelValue":o[4]||(o[4]=e=>l(r).phone=e),type:"text",name:"phone",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),F(t(K,{title:s.$t("customers.no_customers"),description:s.$t("customers.list_of_customers")},{actions:a(()=>[l(V).hasAbilities(l(C).CREATE_CUSTOMER)?(p(),f(w,{key:0,variant:"primary-outline",onClick:o[5]||(o[5]=e=>s.$router.push("/admin/customers/create"))},{left:a(e=>[t(m,{name:"PlusIcon",class:k(e.class)},null,8,["class"])]),default:a(()=>[b(" "+i(s.$t("customers.add_new_customer")),1)]),_:1})):U("",!0)]),default:a(()=>[t(_e,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[A,l(P)]]),F(d("div",he,[d("div",be,[l(u).selectedCustomers.length?(p(),f(Z,{key:0},{activator:a(()=>[d("span",Ce,[b(i(s.$t("general.actions"))+" ",1),t(m,{name:"ChevronDownIcon"})])]),default:a(()=>[t(Q,{onClick:q},{default:a(()=>[t(m,{name:"TrashIcon",class:"mr-3 text-gray-600"}),b(" "+i(s.$t("general.delete")),1)]),_:1})]),_:1})):U("",!0)]),t(ae,{ref:(e,T)=>{T.tableComponent=e,M(_)?_.value=e:_=e},class:"mt-3",data:G,columns:l(Y)},me({header:a(()=>[d("div",Be,[t(N,{modelValue:l(S),"onUpdate:modelValue":o[6]||(o[6]=e=>M(S)?S.value=e:null),variant:"primary",onChange:l(u).selectAllCustomers},null,8,["modelValue","onChange"])])]),"cell-status":a(({row:e})=>[d("div",ge,[t(N,{id:e.data.id,modelValue:l($),"onUpdate:modelValue":o[7]||(o[7]=T=>M($)?$.value=T:null),value:e.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-name":a(({row:e})=>[t(ee,{to:{path:`customers/${e.data.id}/view`}},{default:a(()=>[t(O,{text:e.data.name,length:30,tag:"span",class:"font-medium text-primary-500 flex flex-col"},null,8,["text"]),t(O,{text:e.data.contact_name?e.data.contact_name:"",length:30,tag:"span",class:"text-xs text-gray-400"},null,8,["text"])]),_:2},1032,["to"])]),"cell-phone":a(({row:e})=>[d("span",null,i(e.data.phone?e.data.phone:"-"),1)]),"cell-due_amount":a(({row:e})=>[t(te,{amount:e.data.due_amount||0,currency:e.data.currency},null,8,["amount","currency"])]),"cell-created_at":a(({row:e})=>[d("span",null,i(e.data.formatted_created_at),1)]),_:2},[L()?{name:"cell-actions",fn:a(({row:e})=>[t(fe,{row:e.data,table:l(_),"load-data":D},null,8,["row","table"])])}:void 0]),1032,["columns"])],512),[[A,!l(P)]])]),_:1})}}};export{$e as default};
